---
import ContactFormFields from './ContactFormFields.astro';
---

<dialog id="contact-modal" class="backdrop:backdrop-blur-sm backdrop:bg-black/50 bg-transparent p-0 w-full h-full max-w-full max-h-full m-0 bg-transparent border-0 outline-0 open:flex items-center justify-center pointer-events-none open:pointer-events-auto z-50 fixed inset-0">
  <div class="bg-white w-full max-w-4xl max-h-[90vh] overflow-y-auto shadow-2xl relative p-8 md:p-16 flex flex-col gap-8 mx-4 pointer-events-auto">
    
    <!-- Close Button -->
    <button id="close-modal" class="absolute top-6 right-6 text-black-soft/40 hover:text-black-soft transition-colors p-2">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>

    <!-- Header -->
    <div class="flex flex-col gap-4 text-center items-center">
      <img src="/home/logo2.webp" alt="BA Logo" class="w-24 h-auto drop-shadow-md mb-4 invert brightness-0" />
      <h2 class="text-3xl md:text-[40px] leading-tight font-normal text-black-soft m-0">
        Start your project now!
      </h2>
    </div>

    <!-- Reusable Form -->
    <ContactFormFields formId="modal-contact-form" isModal={true} />
    
  </div>
</dialog>

<script>
  const dialog = document.getElementById('contact-modal') as HTMLDialogElement;
  const closeBtn = document.getElementById('close-modal');

  // We'll listen for a custom event or let other components open it directly
  window.addEventListener('open-contact-modal', () => {
    dialog?.showModal();
    document.body.style.overflow = 'hidden'; // Prevent background scrolling
  });

  const close = () => {
    dialog?.close();
    document.body.style.overflow = '';
  }

  closeBtn?.addEventListener('click', close);
  
  // Close on backdrop click
  dialog?.addEventListener('click', (e) => {
    if (e.target === dialog) close();
  });
</script>

<style>
  dialog[open] {
    display: flex;
    animation: fadeIn 0.3s ease-out forwards;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
</style>
