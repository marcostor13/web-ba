---
import AdminLayout from "../../layouts/AdminLayout.astro";
import { actions } from "astro:actions";

const user = Astro.locals.user;
if (user) {
	return Astro.redirect("/admin");
}

const result = Astro.getActionResult(actions.register);
if (result?.data?.success) {
	return Astro.redirect("/admin");
}
---

<AdminLayout title="Register">
	<div class="max-w-md mx-auto mt-20 p-10 bg-white shadow-xl rounded-sm border border-black-soft/5">
		<h1 class="text-3xl font-light mb-8 uppercase tracking-widest text-center">Register Admin</h1>
		
		<form method="POST" action={actions.register} class="flex flex-col gap-6">
			<div class="flex flex-col gap-2">
				<label for="username" class="text-[10px] uppercase tracking-[0.2em] text-black-soft/60">Desired Username</label>
				<input 
					type="text" 
					name="username" 
					id="username" 
					required 
					minlength="3"
					class="border-b border-black-soft/20 py-2 focus:border-gold outline-none transition-colors font-light"
				/>
			</div>
			
			<div class="flex flex-col gap-2">
				<label for="password" class="text-[10px] uppercase tracking-[0.2em] text-black-soft/60">Password</label>
				<input 
					type="password" 
					name="password" 
					id="password" 
					required 
					minlength="6"
					class="border-b border-black-soft/20 py-2 focus:border-gold outline-none transition-colors font-light"
				/>
			</div>

			{result?.error && (
				<p class="text-red-500 text-xs text-center font-light mt-2 italic">{result.error.message}</p>
			)}

			<button 
				type="submit" 
				class="mt-4 bg-black-soft text-white py-4 px-8 uppercase tracking-[0.3em] text-[12px] font-medium hover:bg-gold transition-colors"
			>
				Create Account
			</button>
		</form>
    
    <div class="mt-8 text-center">
      <p class="text-[11px] text-black-soft/40 uppercase tracking-widest">
        Already have an account? <a href="/admin/login" class="text-gold border-b border-gold/30 hover:border-gold transition-all">Login</a>
      </p>
    </div>
	</div>
</AdminLayout>
